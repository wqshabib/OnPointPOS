
@{
    ViewBag.Title = "ApiTester";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<link href="~/Content/themes/base/jquery-ui.css" rel="stylesheet" />


<div class="container body-content">



    <h2>Test APIs</h2>


    <link href="/Content/jquery-ui.css" rel="stylesheet" />

    <input type="hidden" id="api_access_token" value="" />

    <div id="Regdialog" title="Registration" style="display:none">
        <form role="form">
            <div class="form-group">
                <label> Email:</label>
                <input placeholder="Email" id="Email" class="form-control" />

            </div>
            <div class="form-group">
                <label> First Name:</label>
                <input placeholder="First Name" id="um_firstname" class="form-control" />

            </div>
            <div class="form-group">
                <label> Last Name:</label>
                <input placeholder="Last Name" id="um_lastname" class="form-control" />

            </div>

            <div class="form-group">
                <label> Password:</label>
                <input type="password" placeholder="Password" id="um_password" class="form-control" />
            </div>
            <div class="form-group">
                <label> Confirm Password:</label>
                <input type="password" placeholder="Conform Password" id="um_conformpassword" class="form-control" />
            </div>

        </form>



    </div>


    <div id="dialog" style="display:none" title="Login">
        <form role="form">

            <div class="form-group">
                <label> User Name:</label>
                <input placeholder="Username" id="um_username_1" value="shahid" class="form-control" />

            </div>
            <div class="form-group">
                <label> Password:</label>
                <input type="password" placeholder="Password" id="um_password_1" value="Luqon12345" class="form-control" />
            </div>

        </form>


    </div>


    <div id="PrinterUpdateOrderStatusdialog" title="Update Order Status " style="display:none">
        <form role="form">
            <div class="form-group">
                <input placeholder="OrderGuid" id="txtPrinterUpdateOrderGuid" value="ecf48db2-6f98-424a-9f10-b684afa6b124" class="form-control" />
            </div>

            <div class="form-group">

                <input placeholder="PickUpTime" id="txtPrinterUpdatePickUpTime" value="2015-11-26 12:00" class="form-control" />

            </div>
            <div class="form-group">

                <input placeholder="DeliveryTime" id="txtPrinterUpdateDeliveryTime" value="2015-11-26 12:00" class="form-control" />

            </div>

            <div class="form-group">
                <select id="PrinterUpdatecmdOrderStatus" class="form-control">

                    <option value="-4"> ErrorAcknowledging </option>
                    <option value="-3"> ErrorCompleting</option>
                    <option value="-2"> ErrorProcessing</option>
                    <option value="-1"> ErrorCreating </option>
                    <option value="0"> None</option>
                    <option value="1"> Creating </option>
                    <option value="2"> Created </option>
                    <option value="3"> Processing  </option>
                    <option value="4"> Processed </option>
                    <option value="5"> Completing  </option>
                    <option value="6"> Completed </option>
                    <option value="7"> CustomerNotifiedClient  </option>
                    <option value="8"> CustomerNotifiedSms </option>
                    <option value="9"> TimeOut  </option>
                    <option value="10"> Rejected </option>
                    <option value="11"> DriverConfirmed  </option>
                    <option value="12"> ReadyToPickup </option>
                    <option value="13"> OnWay </option>
                    <option value="14"> Accepted </option>
                    <option value="15"> Delivered </option>
                    <option value="16"> ShopConfirmed </option>
                    <option value="17"> ShopAcknowledged </option>
                    <option value="18"> DriverAcknowledged </option>
                </select>
            </div>


        </form>
    </div>

    <div id="DrivifyUpdateOrderStatusdialog" title="Update Order Status " style="display:none">
        <form role="form">
            <div class="form-group">
                <input placeholder="OrderGuid" id="txtDrivifyUpdateOrderGuid" value="ecf48db2-6f98-424a-9f10-b684afa6b124" class="form-control" />
            </div>

            <div class="form-group">

                <input placeholder="PickUpTime" id="txtDrivifyUpdatePickUpTime" value="2015-11-26 12:00" class="form-control" />

            </div>
            <div class="form-group">

                <input placeholder="DeliveryTime" id="txtDrivifyUpdateDeliveryTime" value="2015-11-26 12:00" class="form-control" />

            </div>

            <div class="form-group">
                <select id="DrivifyUpdatecmdOrderStatus" class="form-control">

                    <option value="-4"> ErrorAcknowledging </option>
                    <option value="-3"> ErrorCompleting</option>
                    <option value="-2"> ErrorProcessing</option>
                    <option value="-1"> ErrorCreating </option>
                    <option value="0"> None</option>
                    <option value="1"> Creating </option>
                    <option value="2"> Created </option>
                    <option value="3"> Processing  </option>
                    <option value="4"> Processed </option>
                    <option value="5"> Completing  </option>
                    <option value="6"> Completed </option>
                    <option value="7"> CustomerNotifiedClient  </option>
                    <option value="8"> CustomerNotifiedSms </option>
                    <option value="9"> TimeOut  </option>
                    <option value="10"> Rejected </option>
                    <option value="11"> DriverConfirmed  </option>
                    <option value="12"> ReadyToPickup </option>
                    <option value="13"> OnWay </option>
                    <option value="14"> Accepted </option>
                    <option value="15"> Delivered </option>
                    <option value="16"> ShopConfirmed </option>
                    <option value="17"> ShopAcknowledged </option>
                    <option value="18"> DriverAcknowledged </option>
                </select>
            </div>


        </form>
    </div>

    <div class="">
        <div class="col-lg-4">
            <div class="row">
                <ul class="nav navbar-nav">
                    <li><a id="Login_dialog_link"><i class="fa fa-user"></i> Login</a></li>
                    <li><a id="Reg_dialog_link"><i class="fa fa-edit"></i> Register</a></li>

                </ul>
            </div>

            <div class="row">

                <div class="form-horizontal">

                    <div class="form-group">
                        <hr />
                        <label>Shop Printer Section</label>
                        <hr />
                    </div>

                    <div class="form-group">
                        <input type="button" id="btnPrinterGetOrderHistoryCompleted" value="Get Order History Completed" class="btn btn-primary form-control" />
                    </div>

                    <div class="form-group">
                        <input type="button" id="btnPrinterUpdateOrderStatus" value="Update Order Status" class="btn btn-default form-control" />
                    </div>

                    <div class="form-group">
                        <input type="button" id="btnPrinterPendingOrders" value="Get Pending Orders" class="btn btn-danger form-control" />
                    </div>

                    <div class="form-group">
                        <input type="text" id="txtPrinterOrderGuid" value="BC6D36C0-1080-4679-87C8-81FCE1B827CC" class="form-control" />
                    </div>

                    <div class="form-group">
                        <input type="button" id="btnPrinterGetOrderItem" value="Get Order Item Detail" class="btn btn-primary form-control" />
                    </div>


                    <div class="form-group">
                        <hr />
                        <label>Drivify Section</label>
                        <hr />
                    </div>

                    <div class="form-group">
                        <input type="button" id="btnDrivifyGetOrderHistoryCompleted" value="Get Order History Completed" class="btn btn-primary form-control" />
                    </div>

                    <div class="form-group">
                        <input type="button" id="btnDrivifyUpdateOrderStatus" value="Update Order Status" class="btn btn-default form-control" />
                    </div>

                    <div class="form-group">
                        <input type="button" id="btnDrivifyPendingOrders" value="Get Pending Orders" class="btn btn-danger form-control" />
                    </div>

                    <div class="form-group">
                        <input type="text" id="txtDrivifyOrderGuid" value="BC6D36C0-1080-4679-87C8-81FCE1B827CC" class="form-control" />
                    </div>

                    <div class="form-group">
                        <input type="button" id="btnDrivifyGetOrderItem" value="Get Order Item Detail" class="btn btn-primary form-control" />
                    </div>


                    <div class="form-group">
                        <input type="button" id="btnDrivifyPendingOrderNotAssign" value="Get Pending Order Not Assign" class="btn btn-success form-control" />
                    </div>
                    <div class="form-group">
                        <input type="button" id="btnDrivifyPendingOrdersDriverConfirmed" value="Get Pending Orders Driver Confirmed" class="btn btn-primary form-control" />
                    </div>

                </div>



            </div>
        </div>
    </div>

    <div class="col-lg-8">
        <div class="row"><h2>Result</h2></div>
        <div id="divresult" class="row"></div>
    </div>





   
</div>
@section scripts{

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js" type="text/javascript"></script>


<script>
       // var rootPath = "http://" + window.location.host + '/';
        var rootPath = "http://rest2.moblink.se/";
        //var rootPath = "http://template3.letuseat.se/";
        $(document).ready(function () {


            // Dialog
            $('#dialog').dialog({
                autoOpen: false,
                width: 500, modal: true,
                buttons: {
                    "Login": function () {

                        var _data = {
                            "UserName": $('#um_username_1').val(),
                            "Password": $('#um_password_1').val(),
                            "RememberMe": "True"
                        };
                        
                        $.ajax({
                            type: "POST",
                            //url: rootPath + 'Token',
                            url: rootPath + 'api/Account/Login',
                            data: JSON.stringify(_data),
                            //data: 'grant_type=password&username=' + $('#um_username_1').val() + '&password=' + $('#um_password_1').val(),
                            contentType: "application/json; charset=utf-8",
                            success: function (_d) {

                                $('#um_username_1').val("");

                                $('#um_password_1').val("");
                                $('#api_access_token').val(_d);
                                alert(JSON.stringify("A valid token issued" + _d));
                                $('#dialog').dialog("close");
                            }
                        }).fail(function (_d) { alert(JSON.stringify(_d)); });

                    },
                    "Cancel": function () {
                        $(this).dialog("close");
                    }
                }
            });



            //Registration

            $('#Regdialog').dialog({
                autoOpen: false,
                width: 500, modal: true,
                buttons: {
                    "Ok": function () {
                        var _data = {
                            "UserName": $('#Email').val(),
                            "Email": $('#Email').val(),
                            "FirstName": $('#um_firstname').val(),
                            "LastName": $('#um_lastname').val(),
                            "Password": $('#um_password').val(),
                            "ConfirmPassword": $('#um_conformpassword').val()
                        };
                        $.ajax({
                            type: "POST",
                            url: rootPath + 'api/AccountV1/Register/',
                            data: JSON.stringify(_data),
                            contentType: "application/json; charset=utf-8",
                            success: function (_d) {
                                alert("User Registered successfully");
                                $('#Regdialog').dialog("close");
                            }
                        }).fail(function (_d) { alert(JSON.stringify(_d)); });

                    },
                    "Cancel": function () {
                        $(this).dialog("close");
                    }
                }
            });


            // Dialog Link
            $('#Login_dialog_link').click(function () {
                var url = rootPath;

                if (url == "") {
                    alert("Enter api url");
                }
                else {
                    $('#dialog').dialog('open');
                    return false;
                }
            });
            //Open Register Dialog
            $('#Reg_dialog_link').click(function () {
                var url = $('#api_url').val();
                if (url == "") {
                    alert("Enter api url");
                }
                else {
                    $('#Regdialog').dialog('open');
                    return false;
                }
            });




            //Shop Printer Section

            $('#btnPrinterUpdateOrderStatus').click(function () {
                if ($('#api_access_token').val() == '') {
                    $('#dialog').dialog('open');
                    return;
                }
                else {
                    $('#PrinterUpdateOrderStatusdialog').dialog('open');
                }
            });

            $('#btnPrinterGetOrderHistoryCompleted').click(function () {
                if ($('#api_access_token').val() == '') {
                    $('#dialog').dialog('open');
                    return;
                }
                else {
                    PrinterGetOrderHistoryCompleted();
                }

            });

            $('#PrinterUpdateOrderStatusdialog').dialog({
                autoOpen: false,
                width: 500, modal: true,
                buttons: {
                    "Ok": function () {
                        var _data = {
                            "token": $('#api_access_token').val(),
                            "OrderGuid": $('#txtPrinterUpdateOrderGuid').val(),
                            "OrderStatus": $('#PrinterUpdatecmdOrderStatus').val(),
                            "PickUpTime": $('#txtPrinterUpdatePickUpTime').val(),
                            "DeliveryTime": $('#txtPrinterUpdateDeliveryTime').val()
                        };

                        $.ajax({
                            type: "POST",
                            url: rootPath + 'api/ShopPrinter/UpdateOrderStatus',
                            data: JSON.stringify(_data),
                            contentType: "application/json; charset=utf-8",

                            success: function (_d) {
                                $('#divresult').html(_d);
                                $('#PrinterUpdateOrderStatusdialog').dialog("close");
                            }
                        }).fail(function (_d) { alert(JSON.stringify(_d)); });

                    },
                    "Cancel": function () {
                        $(this).dialog("close");
                    }
                }
            });

            $('#btnPrinterPendingOrders').click(function () {
                if ($('#api_access_token').val() == '') {
                    $('#dialog').dialog('open');
                    return;
                }
                else {
                    PrinterGetPendingOrders();
                }

            });

            $('#btnPrinterGetOrderItem').click(function () {
                if ($('#api_access_token').val() == '') {
                    $('#dialog').dialog('open');
                    return;
                }
                else {
                    PrinterGetOrderItem();
                }

            });



            //Drivify Section

            $('#btnDrivifyUpdateOrderStatus').click(function () {
                if ($('#api_access_token').val() == '') {
                    $('#dialog').dialog('open');
                    return;
                }
                else {
                    $('#DrivifyUpdateOrderStatusdialog').dialog('open');
                }
            });

            $('#btnDrivifyGetOrderHistoryCompleted').click(function () {
                if ($('#api_access_token').val() == '') {
                    $('#dialog').dialog('open');
                    return;
                }
                else {
                    DrivifyGetOrderHistoryCompleted();
                }

            });

            $('#DrivifyUpdateOrderStatusdialog').dialog({
                autoOpen: false,
                width: 500, modal: true,
                buttons: {
                    "Ok": function () {
                        var _data = {
                            "token": $('#api_access_token').val(),
                            "OrderGuid": $('#txtDrivifyUpdateOrderGuid').val(),
                            "OrderStatus": $('#DrivifyUpdatecmdOrderStatus').val(),
                            "PickUpTime": $('#txtDrivifyUpdatePickUpTime').val(),
                            "DeliveryTime": $('#txtDrivifyUpdateDeliveryTime').val()
                        };

                        $.ajax({
                            type: "POST",
                            url: rootPath + 'api/Drivify/UpdateOrderStatus',
                            data: JSON.stringify(_data),
                            contentType: "application/json; charset=utf-8",

                            success: function (_d) {
                                $('#divresult').html(_d);
                                $('#DrivifyUpdateOrderStatusdialog').dialog("close");
                            }
                        }).fail(function (_d) { alert(JSON.stringify(_d)); });

                    },
                    "Cancel": function () {
                        $(this).dialog("close");
                    }
                }
            });

            $('#btnDrivifyPendingOrders').click(function () {
                if ($('#api_access_token').val() == '') {
                    $('#dialog').dialog('open');
                    return;
                }
                else {
                    DrivifyGetPendingOrders();
                }

            });

            $('#btnDrivifyGetOrderItem').click(function () {
                if ($('#api_access_token').val() == '') {
                    $('#dialog').dialog('open');
                    return;
                }
                else {

                    DrivifyGetOrderItem();
                }

            });

            $('#btnDrivifyPendingOrderNotAssign').click(function () {
                if ($('#api_access_token').val() == '') {
                    $('#dialog').dialog('open');
                    return;
                }
                else {
                    GetPendingOrderNotAssign();
                }

            });

            $('#btnDrivifyPendingOrdersDriverConfirmed').click(function () {
                if ($('#api_access_token').val() == '') {
                    $('#dialog').dialog('open');
                    return;
                }
                else {
                    GetPendingOrdersDriverConfirmed();
                }

            });


        })

        //Shop Printer Section

        function PrinterGetOrderHistoryCompleted() {
            $('#divresult').html('');

            $.ajax({
                type: "Get",
                url: rootPath + 'api/ShopPrinter/GetOrderHistoryCompleted',
                data: { token: $('#api_access_token').val() },
                success: function (result) {

                    $('#divresult').html(JSON.stringify(result));
                },
                error: function (err) {
                    alert(JSON.stringify(err));
                }
            });
        }

        function PrinterGetPendingOrders() {
            $('#divresult').html('');

            $.ajax({
                type: "Get",
                url: rootPath + 'api/ShopPrinter/GetPendingOrders',
                data: { token: $('#api_access_token').val() },
                success: function (result) {

                    $('#divresult').html(JSON.stringify(result));
                },
                error: function (err) {
                    alert(JSON.stringify(err));
                }
            });
        }

        function PrinterGetOrderItem() {
            $('#divresult').html('');

            $.ajax({
                type: "Get",
                url: rootPath + 'api/ShopPrinter/GetOrderDetail',
                data: { token: $('#api_access_token').val(), OrderGuid: $('#txtPrinterOrderGuid').val() },
                success: function (result) {

                    $('#divresult').html(JSON.stringify(result));
                },
                error: function (err) {
                    alert(JSON.stringify(err));
                }
            });
        }


        //Drivify Section

        function DrivifyGetOrderHistoryCompleted() {
            $('#divresult').html('');

            $.ajax({
                type: "Get",
                url: rootPath + 'api/Drivify/GetOrderHistoryCompleted',
                data: { token: $('#api_access_token').val() },
                success: function (result) {

                    $('#divresult').html(JSON.stringify(result));
                },
                error: function (err) {
                    alert(JSON.stringify(err));
                }
            });
        }

        function DrivifyGetPendingOrders() {
            $('#divresult').html('');

            $.ajax({
                type: "Get",
                url: rootPath + 'api/Drivify/GetPendingOrders',
                data: { token: $('#api_access_token').val() },
                success: function (result) {

                    $('#divresult').html(JSON.stringify(result));
                },
                error: function (err) {
                    alert(JSON.stringify(err));
                }
            });
        }

        function DrivifyGetOrderItem() {
            $('#divresult').html('');

            $.ajax({
                type: "Get",
                url: rootPath + 'api/Drivify/GetOrderDetail',
                data: { token: $('#api_access_token').val(), OrderGuid: $('#txtDrivifyOrderGuid').val() },
                success: function (result) {

                    $('#divresult').html(JSON.stringify(result));
                },
                error: function (err) {
                    alert(JSON.stringify(err));
                }
            });
        }

        function GetPendingOrderNotAssign() {
            $('#divresult').html('');

            $.ajax({
                type: "Get",
                url: rootPath + 'api/Drivify/GetPendingOrderNotAssign',
                data: { token: $('#api_access_token').val() },
                success: function (result) {

                    $('#divresult').html(JSON.stringify(result));
                },
                error: function (err) {
                    alert(JSON.stringify(err));
                }
            });
        }

        function GetPendingOrdersDriverConfirmed() {
            $('#divresult').html('');

            $.ajax({
                type: "Get",
                url: rootPath + 'api/Drivify/GetPendingOrdersDriverConfirmed',
                data: { token: $('#api_access_token').val() },
                success: function (result) {

                    $('#divresult').html(JSON.stringify(result));
                },
                error: function (err) {
                    alert(JSON.stringify(err));
                }
            });
        }






</script>

    }

